{
  "alerts": [
    {
      "condition": "MTTD > 4 hours",
      "frequency": "Once per incident",
      "name": "High MTTD Alert",
      "notification": "Slack #soc-alerts, Email SOC Manager"
    },
    {
      "condition": "severity = critical",
      "frequency": "Immediate",
      "name": "Critical Incident Alert",
      "notification": "PagerDuty, Phone call to Incident Commander"
    },
    {
      "condition": "False Positive Rate > 20%",
      "frequency": "Daily digest",
      "name": "High False Positive Rate",
      "notification": "Email SOC Manager"
    }
  ],
  "annotations": [
    {
      "color": "#C4162A",
      "datasource": "Splunk",
      "name": "Major Incidents",
      "query": "index=incidents severity=critical | eval time=_time, text=concat(\"Critical: \", title)"
    },
    {
      "color": "#1F60C4",
      "datasource": "Splunk",
      "name": "System Maintenance",
      "query": "index=maintenance | eval time=_time, text=concat(\"Maintenance: \", description)"
    }
  ],
  "dashboard": {
    "description": "Real-time security metrics: MTTD, MTTR, incident trends, SOC workload",
    "panels": [
      {
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 0,
          "y": 0
        },
        "id": 1,
        "options": {
          "thresholds": [
            {
              "color": "green",
              "value": 0
            },
            {
              "color": "yellow",
              "value": 1
            },
            {
              "color": "red",
              "value": 4
            }
          ],
          "unit": "hours"
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents | eval ttd_hours=(detection_time-occurrence_time)/3600 | stats avg(ttd_hours) as mttd",
            "refId": "A"
          }
        ],
        "title": "Mean Time To Detect (MTTD)",
        "type": "stat"
      },
      {
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 6,
          "y": 0
        },
        "id": 2,
        "options": {
          "thresholds": [
            {
              "color": "green",
              "value": 0
            },
            {
              "color": "yellow",
              "value": 2
            },
            {
              "color": "red",
              "value": 8
            }
          ],
          "unit": "hours"
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents | eval ttr_hours=(containment_time-detection_time)/3600 | stats avg(ttr_hours) as mttr",
            "refId": "A"
          }
        ],
        "title": "Mean Time To Respond (MTTR)",
        "type": "stat"
      },
      {
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 12,
          "y": 0
        },
        "id": 3,
        "options": {
          "colorMode": "background",
          "thresholds": [
            {
              "color": "green",
              "value": 0
            },
            {
              "color": "yellow",
              "value": 5
            },
            {
              "color": "red",
              "value": 10
            }
          ]
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents status=\"in_progress\" | stats count",
            "refId": "A"
          }
        ],
        "title": "Active Incidents",
        "type": "stat"
      },
      {
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 18,
          "y": 0
        },
        "id": 4,
        "options": {
          "max": 100,
          "min": 0,
          "thresholds": [
            {
              "color": "green",
              "value": 0
            },
            {
              "color": "yellow",
              "value": 10
            },
            {
              "color": "red",
              "value": 20
            }
          ],
          "unit": "percent"
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=alerts | stats count(eval(verdict=\"false_positive\")) as fp, count as total | eval fp_rate=(fp/total)*100",
            "refId": "A"
          }
        ],
        "title": "False Positive Rate",
        "type": "gauge"
      },
      {
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 0,
          "y": 4
        },
        "id": 5,
        "options": {
          "legend": {
            "position": "bottom",
            "show": true
          },
          "seriesOverrides": [
            {
              "alias": "critical",
              "color": "#C4162A"
            },
            {
              "alias": "high",
              "color": "#FF7383"
            },
            {
              "alias": "medium",
              "color": "#FFEE52"
            },
            {
              "alias": "low",
              "color": "#73BF69"
            }
          ],
          "xaxis": {
            "mode": "time"
          },
          "yaxis": {
            "label": "Incident Count"
          }
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents earliest=-30d | timechart span=1d count by severity",
            "refId": "A"
          }
        ],
        "title": "Incident Trends (Last 30 Days)",
        "type": "graph"
      },
      {
        "gridPos": {
          "h": 8,
          "w": 6,
          "x": 12,
          "y": 4
        },
        "id": 6,
        "options": {
          "legend": {
            "position": "right",
            "show": true
          },
          "pieType": "donut"
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents earliest=-30d | stats count by type",
            "refId": "A"
          }
        ],
        "title": "Incident Type Distribution",
        "type": "piechart"
      },
      {
        "gridPos": {
          "h": 8,
          "w": 6,
          "x": 18,
          "y": 4
        },
        "id": 7,
        "options": {
          "colors": {
            "critical": "#C4162A",
            "high": "#FF7383",
            "low": "#73BF69",
            "medium": "#FFEE52"
          },
          "legend": {
            "position": "right",
            "show": true
          }
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents earliest=-30d | stats count by severity",
            "refId": "A"
          }
        ],
        "title": "Severity Breakdown",
        "type": "piechart"
      },
      {
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 0,
          "y": 12
        },
        "id": 8,
        "options": {
          "displayMode": "gradient",
          "orientation": "horizontal",
          "thresholds": [
            {
              "color": "green",
              "value": 0
            },
            {
              "color": "yellow",
              "value": 100
            },
            {
              "color": "red",
              "value": 500
            }
          ]
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=alerts earliest=-24h | stats count by source | sort -count | head 10",
            "refId": "A"
          }
        ],
        "title": "Top 10 Alert Sources",
        "type": "bargauge"
      },
      {
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 12,
          "y": 12
        },
        "id": 9,
        "options": {
          "colorScheme": "interpolateRdYlGn",
          "xAxis": {
            "label": "Hour of Day"
          },
          "yAxis": {
            "label": "Day of Week"
          }
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents | eval hour=strftime(_time, \"%H\"), day=strftime(_time, \"%A\") | stats count by day, hour",
            "refId": "A"
          }
        ],
        "title": "SOC Analyst Workload (Heatmap)",
        "type": "heatmap"
      },
      {
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 0,
          "y": 20
        },
        "id": 10,
        "options": {
          "legend": {
            "position": "bottom",
            "show": true
          },
          "xaxis": {
            "mode": "time"
          },
          "yaxis": {
            "label": "Hours",
            "min": 0
          }
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents earliest=-7d | eval ttd_hours=(detection_time-occurrence_time)/3600, ttr_hours=(containment_time-detection_time)/3600 | timechart span=1d avg(ttd_hours) as \"MTTD\", avg(ttr_hours) as \"MTTR\"",
            "refId": "A"
          }
        ],
        "title": "MTTD/MTTR Trend (7 Days)",
        "type": "graph"
      },
      {
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 12,
          "y": 20
        },
        "id": 11,
        "options": {
          "basemap": {
            "type": "carto-light"
          },
          "colorScheme": "interpolateReds",
          "view": {
            "id": "coords",
            "lat": 20,
            "lon": 0,
            "zoom": 2
          }
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents | iplocation src_ip | stats count by Country",
            "refId": "A"
          }
        ],
        "title": "Threat Actor Attribution (Geolocation)",
        "type": "geomap"
      },
      {
        "gridPos": {
          "h": 6,
          "w": 12,
          "x": 0,
          "y": 28
        },
        "id": 12,
        "options": {
          "fill": 1,
          "legend": {
            "show": false
          },
          "linewidth": 2,
          "xaxis": {
            "mode": "time"
          },
          "yaxis": {
            "label": "Alerts per 5 minutes"
          }
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=alerts | timechart span=5m count",
            "refId": "A"
          }
        ],
        "title": "Alert Volume (Real-Time)",
        "type": "graph"
      },
      {
        "gridPos": {
          "h": 6,
          "w": 12,
          "x": 12,
          "y": 28
        },
        "id": 13,
        "options": {
          "columns": [
            {
              "text": "Hostname",
              "value": "dest_host"
            },
            {
              "text": "Incidents",
              "value": "incident_count"
            },
            {
              "text": "Incident Types",
              "value": "incident_types"
            }
          ]
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents | stats count as incident_count, values(type) as incident_types by dest_host | sort -incident_count | head 5",
            "refId": "A"
          }
        ],
        "title": "Top 5 Targeted Assets",
        "type": "table"
      },
      {
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 0,
          "y": 34
        },
        "id": 14,
        "options": {
          "thresholds": [
            {
              "color": "red",
              "value": 0
            },
            {
              "color": "yellow",
              "value": 80
            },
            {
              "color": "green",
              "value": 95
            }
          ],
          "unit": "percent"
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents earliest=-7d | stats count(eval(status=\"resolved\")) as resolved, count as total | eval resolution_rate=(resolved/total)*100",
            "refId": "A"
          }
        ],
        "title": "Incident Resolution Rate",
        "type": "stat"
      },
      {
        "gridPos": {
          "h": 4,
          "w": 6,
          "x": 6,
          "y": 34
        },
        "id": 15,
        "options": {
          "thresholds": [
            {
              "color": "green",
              "value": 0
            },
            {
              "color": "yellow",
              "value": 24
            },
            {
              "color": "red",
              "value": 72
            }
          ],
          "unit": "hours"
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents status=\"resolved\" | eval lifetime_hours=(resolved_time-detection_time)/3600 | stats avg(lifetime_hours) as avg_lifetime",
            "refId": "A"
          }
        ],
        "title": "Average Incident Lifetime",
        "type": "stat"
      },
      {
        "gridPos": {
          "h": 4,
          "w": 12,
          "x": 12,
          "y": 34
        },
        "id": 16,
        "options": {
          "displayMode": "lcd",
          "orientation": "horizontal"
        },
        "targets": [
          {
            "datasource": "Splunk",
            "query": "index=incidents status=\"resolved\" earliest=-7d | stats count by assigned_analyst | sort -count",
            "refId": "A"
          }
        ],
        "title": "SOC Team Performance (Incidents Resolved)",
        "type": "bargauge"
      }
    ],
    "refresh": "30s",
    "tags": [
      "security",
      "soc",
      "incident-response",
      "nist"
    ],
    "time": {
      "from": "now-24h",
      "to": "now"
    },
    "timezone": "utc",
    "title": "Security Operations Center (SOC) Metrics Dashboard"
  },
  "installation": {
    "requirements": [
      "Grafana 9.0+",
      "SIEM integration (Splunk, ELK, or Azure Sentinel)",
      "Incident tracking system (ServiceNow, Jira, or custom)",
      "GeoIP database for threat actor geolocation"
    ],
    "steps": [
      "1. Import this JSON file into Grafana (Dashboard > Import)",
      "2. Configure data source connections (Splunk/ELK/Azure Sentinel)",
      "3. Update queries to match your index/field names",
      "4. Set up alert notification channels (Slack, PagerDuty, Email)",
      "5. Adjust refresh interval based on your environment",
      "6. Configure user permissions (read-only for analysts, edit for SOC managers)"
    ]
  },
  "metadata": {
    "author": "SOC Team",
    "created": "2025-01-17",
    "data_sources": [
      "Splunk",
      "ELK",
      "Azure Sentinel"
    ],
    "description": "Grafana dashboard for Security Operations Center metrics aligned with NIST 800-61",
    "nist_controls": [
      "IR-4",
      "IR-5",
      "AU-6",
      "SI-4"
    ],
    "refresh_interval": "30s",
    "retention": "90 days hot, 1 year archive",
    "version": "1.0.0"
  },
  "variables": [
    {
      "default": "all",
      "label": "Severity Filter",
      "name": "severity",
      "options": [
        "critical",
        "high",
        "medium",
        "low"
      ],
      "type": "custom"
    },
    {
      "default": "all",
      "label": "Incident Type",
      "name": "incident_type",
      "query": "index=incidents | stats count by type | fields type",
      "type": "query"
    },
    {
      "default": "Last 24 hours",
      "label": "Time Range",
      "name": "timerange",
      "options": [
        "Last 1 hour",
        "Last 24 hours",
        "Last 7 days",
        "Last 30 days"
      ],
      "type": "interval"
    }
  ]
}
