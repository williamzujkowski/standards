# Audit Rules Configuration
# Last Updated: 2025-08-23
#
# This configuration enforces strict quality gates:
# - Broken links = 0
# - Hub violations = 0
# - Orphans â‰¤ 5
#
# Scheduled audits run weekly: Monday 05:17 UTC
# CI enforces these gates on all PRs to master branch

version: 1

# Audit gate limits
limits:
  broken_links: 0
  hub_violations: 0
  max_orphans: 5

# Link checking exclusions
link_check:
  exclude_files:
    - "skills/**"                    # Skills are self-contained modular system
    - "tests/scripts/fixtures/**"    # Test fixtures with intentional broken links
    - "standards/compliance/node_modules/**"  # NPM dependencies (not our code)
    - "**/node_modules/**"           # All node_modules directories
    - "docs/guides/SKILL_AUTHORING_GUIDE.md"  # Template with example placeholder links
    - "archive/**"                   # Archived historical content (may have outdated links)
    - ".backup/**"                   # Backup directories (historical snapshots)
    - "README.md"                    # Links to planned MIGRATION_GUIDE.md (v2.0 feature)
    - "agents/README.md"             # Links to planned MIGRATION_GUIDE.md (v2.0 feature)
    - "docs/SKILLS_CATALOG.md"       # Links to planned MIGRATION_GUIDE.md (v2.0 feature)
    - "docs/guides/SKILLS_QUICK_START.md"  # Links to planned MIGRATION_GUIDE.md (v2.0 feature)
    - "docs/guides/SKILLS_USER_GUIDE.md"   # Links to planned MIGRATION_GUIDE.md (v2.0 feature)
    - "docs/research/**"             # Research documents (may reference non-existent files)
    - "docs/decisions/**"            # ADRs (may reference superseded documents)

orphans:
  exclude:
    - ".claude/**"           # Agent definitions (modular design)
    - "subagents/**"         # Subagent configurations
    - "memory/**"            # Session management files
    - "prompts/**"           # Individual prompt files
    - "reports/generated/**"  # Generated reports (transient)
    - ".vscode/**"           # IDE configuration
    - ".git/**"              # Git internal files
    - "node_modules/**"      # Node.js dependencies (root)
    - "**/node_modules/**"   # Node.js dependencies (all levels)
    - "standards/compliance/node_modules/**"  # Compliance tool dependencies
    - "__pycache__/**"       # Python cache (root level)
    - ".github/**"           # GitHub configuration files
    - ".backup/**"           # Backup directories
    - ".backup/"             # Backup root
    - "**/.backup/**"        # Backup directories (all levels)
    - ".claude-flow/**"      # Claude Flow runtime
    - ".hive-mind/**"        # Hive Mind sessions
    - ".swarm/**"            # Swarm coordination
    - ".nist/**"             # NIST tooling
    - ".ruff_cache/**"       # Ruff linter cache (root level)
    - ".pytest_cache/**"     # Pytest cache (root level)
    - ".benchmarks/**"       # Benchmark data (root level)
    - ".mypy_cache/**"       # Mypy cache (root level)
    - ".tox/**"              # Tox environments
    - "**/.swarm/**"         # Swarm coordination (all levels)
    - "**/.claude-flow/**"   # Claude Flow runtime (all levels)
    - "**/.pytest_cache/**"  # Pytest cache (all levels)
    - "**/__pycache__/**"    # Python cache (all levels)
    - "**/.benchmarks/**"    # Benchmark data (all levels)
    - "**/.ruff_cache/**"    # Ruff cache (all levels)
    - "**/.mypy_cache/**"    # Mypy cache (all levels)
    - "**/.tox/**"           # Tox environments (all levels)
    - "**/*.pyc"             # Compiled Python files
    - "**/.DS_Store"         # macOS metadata
    - "project_plan.md"      # Planning document (intentional)
    - "update_repo.md"       # Completed project plan (Phase 4 executed in d6a1260)
    - "standards/compliance/IMPLEMENTATION_SUMMARY.md"  # Generated report
    - "MIGRATION_LOG.md"      # Jekyll to MkDocs migration log (one-time document)
    - "site/**"               # MkDocs generated site (build output)
    - "skills/**"             # Modular skill system - self-contained with SKILL.md pattern
    - "docs/migration/**"     # Migration planning docs (transient, intentionally isolated)
    - "tests/scripts/fixtures/**"  # Test fixtures (intentionally orphaned for testing)
    - "CLAUDE_backup.md"      # Backup file (temporary)
    - "skills_alignment.md"   # Planning document (temporary)
    - ".playwright-mcp/**"    # Playwright MCP runtime
    - "overrides/**"          # MkDocs theme overrides
    - "**/structure-audit.md"  # Generated audit reports (transient)
    - "archive/**"            # Archived historical content (completed plans, old migrations)
    - "docs/architecture/migration-summary.md"  # Architecture planning document
    - "docs/optimization/PERFORMANCE_SUMMARY.md"  # Performance analysis report
    - "docs/optimization/performance-analysis.md"  # Detailed performance analysis
    - "tests/validation/VALIDATION_SUMMARY.md"  # Test validation summary report
    - "ROUTER_VALIDATION_SUMMARY.md"  # Router validation executive summary
    - "tests/TDD_TEST_SPECIFICATION.md"  # TDD test specification document
    - "tests/integration/TESTING_SUMMARY.md"  # Integration testing summary
    - "tests/validation/NEXT_STEPS.md"  # Validation next steps report
    - "tests/validation/ROUTER_EDGE_CASES_REPORT.md"  # Router edge cases analysis
    - "tests/validation/ROUTER_VALIDATION_REPORT.md"  # Detailed router validation
    - "tests/validation/SKILLS_TEST_SPEC.md"  # TDD skills test specification
    - "tests/validation/TDD_SKILLS_SUMMARY.md"  # TDD skills summary report
    - "reports/healthtech-refactoring-summary.md"  # Healthtech refactoring report
    - "GEMINI.md"                     # Gemini CLI configuration (standalone)
    - "docs/architecture/SKILLS_REFACTORING_EXECUTIVE_SUMMARY.md"  # Executive summary report
    - "docs/optimization/SKILL_OPTIMIZATION_SUMMARY.md"  # Optimization report
    - "docs/research/SKILLS_IMPLEMENTATION_ANALYSIS.md"  # Research analysis
    - "docs/scripts/FIX_ANTHROPIC_COMPLIANCE_GUIDE.md"  # Script documentation

  require_link_from:
    # Standards are linked from the unified hub
    - pattern: "docs/standards/*.md"
      hubs:
        - "docs/standards/UNIFIED_STANDARDS.md"

    # Guides are linked from the guides index
    - pattern: "docs/guides/*.md"
      hubs:
        - "docs/guides/STANDARDS_INDEX.md"

    # Core docs from core hub
    - pattern: "docs/core/*.md"
      hubs:
        - "docs/core/README.md"

    # NIST docs from an explicit NIST hub
    - pattern: "docs/nist/*.md"
      hubs:
        - "docs/nist/README.md"

    # Top-level docs (like VISUAL_NAVIGATION.md, WORKFLOW_*.md) from docs hub
    - pattern: "docs/*.md"
      hubs:
        - "docs/README.md"

    # Examples from examples hub
    - pattern: "examples/**/*.md"
      hubs:
        - "examples/README.md"
    - pattern: "examples/*.md"
      hubs:
        - "examples/README.md"

    # Ops/observability from monitoring hub
    - pattern: "monitoring/**/*.md"
      hubs:
        - "monitoring/README.md"

    # Tooling from tools-config hub
    - pattern: "tools-config/**/*.md"
      hubs:
        - "tools-config/README.md"

    # Micro standards (your *.micro.md live here)
    - pattern: "micro/**/*.md"
      hubs:
        - "micro/README.md"

    # Badges from repo root README
    - pattern: "badges/**/*.md"
      hubs:
        - "README.md"

# Note: skills/** is excluded - it's a self-contained modular system
